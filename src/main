#include <Arduino.h>

// å®šä¹‰å¼•è„š
const int PIR_PIN = 4;     // äººä½“æ£€æµ‹æ¨¡å—çš„ä¿¡å·å¼•è„š
const int LED_PIN = 2;     // æ¿è½½LEDï¼Œç”¨äºè§†è§‰åé¦ˆ

// å˜é‡å£°æ˜
bool lastMotionState = false;
bool currentMotionState = false;
unsigned long lastMotionTime = 0;

void setup() {
  Serial.begin(115200);
  pinMode(PIR_PIN, INPUT);
  pinMode(LED_PIN, OUTPUT);
  
  Serial.println("====================================");
  Serial.println("äººä½“æ£€æµ‹æ¨¡å—æµ‹è¯•ç¨‹åºå¯åŠ¨");
  Serial.println("ç­‰å¾…æ¨¡å—åˆå§‹åŒ–ï¼ˆ30-60ç§’ï¼‰...");
  
  // äººä½“æ£€æµ‹æ¨¡å—éœ€è¦30-60ç§’çš„åˆå§‹åŒ–æ—¶é—´
  delay(1000); // ç­‰å¾…30ç§’
  Serial.println("æ¨¡å—åˆå§‹åŒ–å®Œæˆï¼Œå¼€å§‹æ£€æµ‹...");
  Serial.println("====================================");
  
}

void loop() {
  // è¯»å–äººä½“æ£€æµ‹æ¨¡å—çŠ¶æ€
  currentMotionState = digitalRead(PIR_PIN);
  
  // æ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–
  if (currentMotionState != lastMotionState) {
    lastMotionState = currentMotionState;
    lastMotionTime = millis();
    
    if (currentMotionState) {
      Serial.println("ğŸš¶ æ£€æµ‹åˆ°äººä½“ç§»åŠ¨ï¼");
      digitalWrite(LED_PIN, HIGH); // ç‚¹äº®LED
    } else {
      Serial.println("ğŸ’¤ æ— äººä½“ç§»åŠ¨");
      //digitalWrite(LED_PIN, LOW);  // ç†„ç­LED
    }
  }
   
  // å¦‚æœæ£€æµ‹åˆ°ç§»åŠ¨ï¼ŒæŒç»­æ˜¾ç¤ºç§»åŠ¨çŠ¶æ€
  if (currentMotionState) {
    unsigned long currentTime = millis();
    if (currentTime - lastMotionTime > 1000) { // æ¯ç§’æ›´æ–°ä¸€æ¬¡
      Serial.println("ğŸ“ äººä½“ä»åœ¨æ£€æµ‹èŒƒå›´å†…");
      lastMotionTime = currentTime;
    }
  }
  
  delay(100); // çŸ­æš‚å»¶è¿Ÿï¼Œå‡å°‘CPUå ç”¨
}